
@model UpdateProfileDto;
@{
    ViewData["Title"] = "Update Profile";
    var mesage = TempData["toastMessage"];
    var type = TempData["messageType"];
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
</head>
<body>
    <div class="container mt-5 update-profile-container px-4 py-3">
        <h2 class="text-center content-header">Update Profile</h2>
        <form method="post" asp-action="UpdateProfile" asp-controller="Home">
            <div class="row pt-3">
                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="hidden" asp-for="Id" />
                        <input type="hidden" asp-for="DepartmentId" />
                        <input type="hidden" asp-for="Password" />
                        <input type="text" class="form-control" id="myProfileFirstName" asp-for="FirstName"
                            placeholder="">
                        <label for="myProfileFirstName" class="myProfileLabel">First Name*</label>
                        <span asp-validation-for="FirstName" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="text" class="form-control" id="myProfileLastName" asp-for="LastName" placeholder="">
                        <label for="myProfileLastName" class="myProfileLabel">Last Name*</label>
                        <span asp-validation-for="LastName" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="text" class="form-control" id="myProfileUsername" asp-for="UserName" placeholder="">
                        <label for="myProfileUsername" class="myProfileLabel">User Name*</label>
                        <span asp-validation-for="UserName" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="email" class="form-control" id="myProfileEmail" asp-for="Email" placeholder="">
                        <label for="myProfileEmail" class="myProfileLabel">Email*</label>
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-12">
                    <div class="form-floating">
                    <textarea class="form-control" placeholder="Leave a comment here" id="myProfileAddress" asp-for="Address"
                        style="height: 100px"></textarea>
                    <label for="myProfileAddress" class="myProfileLabel">Address*</label>
                    <span asp-validation-for="Address" class="text-danger"></span>
                </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="text" class="form-control" id="myProfileZipcode" asp-for="Zipcode" placeholder="">
                        <label for="myProfileZipcode" class="myProfileLabel">Zipcode*</label>
                        <span asp-validation-for="Zipcode" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="number" class="form-control" id="myProfileAge" asp-for="Age" placeholder="">
                        <label for="myProfileZipcode" class="myProfileLabel">Age*</label>
                        <span asp-validation-for="Age" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="text" class="form-control" id="myProfileMobileNo" asp-for="MobileNo" placeholder="">
                        <label for="myProfileMobileNo" class="myProfileLabel">Phone*</label>
                        <span asp-validation-for="MobileNo" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="number" class="form-control" id="myProfileSalary" asp-for="Salary" placeholder="">
                        <label for="myProfileZipcode" class="myProfileLabel">Salary*</label>
                        <span asp-validation-for="Salary" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-4">
                    <div class="form-floating">
                        <select class="form-select" id="myProfileCountryId" asp-for="CountryId">
                        </select>
                        <label for="myProfileCountryId" class="myProfileLabel">Country*</label>
                        <span asp-validation-for="CountryId" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-floating">
                        <select class="form-select" id="myProfileStateId" asp-for="StateId">
                        </select>
                        <label for="myProfileStateId" class="myProfileLabel">State*</label>
                        <span asp-validation-for="StateId" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-floating">
                        <select class="form-select" id="myProfileCityId" asp-for="CityId">
                        </select>
                        <label for="myProfileCityId" class="myProfileLabel">City*</label>
                        <span asp-validation-for="CityId" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row pt-3">
                <div class="col-md-6">
                    <div class="form-floating">
                        <select class="form-select" id="myProfileRoleId" asp-for="RoleId" disabled>
                        </select>
                        <label for="myProfileRoleId" class="myProfileLabel">Role*</label>
                        <span asp-validation-for="RoleId" class="text-danger"></span>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-floating">
                        <input type="hidden" asp-for="RoleId">
                        <select class="form-select" id="myProfileGender" asp-for="Gender">
                            <option selected>Select Gender</option>
                            <option value="Male" >Male</option>
                            <option value="Female" >Female</option>
                            <option value="Other" >Other</option>
                        </select>
                        <label for="myProfileGender" class="myProfileLabel">Gender*</label>
                        <span asp-validation-for="Gender" class="text-danger"></span>
                    </div>
                </div>
            </div>

            

            <div class="mb-3 text-center pt-3">
                <button type="submit" class="btn yes-btn me-2">Update Profile</button>
                <button type="submit" class="btn no-btn">Cancel</button>
            </div>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/jquery-validation-unobtrusive@3.2.12/dist/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</body>
</html>
<script>
    $(document).ready(function () {
         var countryId =@Model.CountryId;
        var stateId =@Model.StateId;
        var cityId =@Model.CityId;
        var roleId =@Model.RoleId;
        loadCountries(countryId);
        loadStates(countryId, stateId);
        loadCities(stateId, cityId);
        loadRoles(roleId);
        $("#myProfileCountryId").change(function () {
            var countryId = $(this).val();
            $("#myProfileStateId").html('<option value="">Select State</option>');

            if (countryId) {
                loadStates(countryId);
            }
        });

        $("#myProfileStateId").change(function () {
            var stateId = $(this).val();
            $("#myProfileCityId").html('<option value="">Select City</option>');

            if (stateId) {
                loadCities(stateId);
            }
        });

        toastr.options = {
            closeButton: true,
            progressBar: true,
            positionClass: "toast-top-right",
            timeOut: 5000,
        };
        if ("@mesage" != "") {
            if ("@type" == "success") {
                toastr.success("@mesage");
            }
            else {
                toastr.error("@mesage");
            }
        }
    });

    function loadCountries(selectedCountryId) {
        $.get("/authentication/GetCountries", function (data) {
            if (data && data.length > 0) {
                $("#myProfileCountryId").html(
                    '<option value="">Select Country</option>'
                );
                $.each(data, function (i, country) {
                    const selected =
                        selectedCountryId &&
                            selectedCountryId > 0 &&
                            country.id === selectedCountryId
                            ? "selected"
                            : "";
                    $("#myProfileCountryId").append(
                        `<option value="${country.id}" style="color:#212529" ${selected}>${country.name}</option>`
                    );
                });
            }
        }).fail(function () {
            console.log("Error loading countries.");
        });
    }

    function loadStates(countryId, selectedStateId) {
        $.get(
            "/authentication/GetStatesByCountryId?countryId=" + countryId,
            function (data) {
                if (data && data.length > 0) {
                    $("#myProfileStateId").html('<option value="">Select State</option>');
                    $.each(data, function (i, state) {
                        const selected =
                            selectedStateId &&
                                selectedStateId > 0 &&
                                state.id === selectedStateId
                                ? "selected"
                                : "";
                        $("#myProfileStateId").append(
                            `<option value="${state.id}" style="color:#212529" ${selected}>${state.name}</option>`
                        );
                    });
                }
            }
        ).fail(function () {
            console.log("Error loading states.");
        });
    }

    function loadCities(stateId, selectedCityId) {
        $.get(
            "/authentication/GetCitiesByStateId?stateId=" + stateId,
            function (data) {
                if (data && data.length > 0) {
                    $("#myProfileCityId").html('<option value="">Select City</option>');
                    $.each(data, function (i, city) {
                        const selected =
                            selectedCityId && selectedCityId > 0 && city.id === selectedCityId
                                ? "selected"
                                : "";
                        $("#myProfileCityId").append(
                            `<option value="${city.id}" style="color:#212529" ${selected}>${city.name}</option>`
                        );
                    });
                }
            }
        ).fail(function () {
            console.log("Error loading cities.");
        });
    }

    function loadRoles(selectedRoleId) {
        $.get("/authentication/GetRoles", function (data) {
            console.log(data)
            if (data && data.length > 0) {
                $("#myProfileRoleId").html(
                    '<option value="">Select Role</option>'
                );
                $.each(data, function (i, role) {
                    const selected =
                        selectedRoleId &&
                            selectedRoleId > 0 &&
                            role.id === selectedRoleId
                            ? "selected"
                            : "";
                    $("#myProfileRoleId").append(
                        `<option value="${role.id}" style="color:#212529" ${selected}>${role.name}</option>`
                    );
                });
            }
        }).fail(function () {
            console.log("Error loading roles.");
        });
    }
</script>